<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>mRides: GettingStarted</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="DoxygenLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">mRides
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_m_rides-app__components_firebase-messaging-42_81001_80_80_component__getting_started.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">GettingStarted </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Get Started with Firebase Cloud Messaging for Android</p>
<h2>Configuring Firebase </h2>
<ol type="1">
<li>Create a Firebase project in the <a href="https://console.developers.google.com/" title="Google Developers Console">Firebase Console</a>, if you don't already have one setup. If you have an existing Google project associated with your mobile app, you can use the <b>Import Google Project</b> option. Otherwise, use the <b>Create New Project</b> option.</li>
<li><p class="startli">Click <b>Add Firebase to your Android app</b>.</p>
<p class="startli">a. Enter your app's ***Package Name***</p>
<p class="startli">b. Enter the SHA-1 Hash for your signing certificate. If you don't know how to find this, <a href="https://developer.xamarin.com/guides/android/deployment,_testing,_and_metrics/MD5_SHA1/" title="Finding your SHA-1 Fingerprints">check out this guide</a></p>
</li>
<li>Click <b>Add App</b> and download the ***google-services.json*** file generated for you.</li>
<li>Add the ***google-services.json*** file to your Xamarin.Android project.</li>
<li>Set the <em>Build Action</em> for your ***google-services.json*** file to ***GoogleServicesJson***.</li>
</ol>
<p>The build process will take the api keys and values from your ***google-services.json*** and translate them into the correct resource string key/value pairs in your app.</p>
<h2>Editing your AndroidManifest.xml</h2>
<p>Currently, you will need to manually add the broadcast receiver declarations to your app's <code>AndroidManifest.xml</code> file. You should add these declarations inside of your <code>&lt;application ..&gt;&lt;/application&gt;</code> element:</p>
<div class="fragment"><div class="line">&lt;<span class="keywordtype">receiver</span></div><div class="line">  <span class="keyword">android:name</span>=<span class="stringliteral">&quot;com.google.firebase.iid.FirebaseInstanceIdInternalReceiver&quot;</span></div><div class="line">  <span class="keyword">android:exported</span>=<span class="stringliteral">&quot;false&quot;</span> /&gt;</div><div class="line"></div><div class="line">&lt;<span class="keywordtype">receiver</span></div><div class="line">  <span class="keyword">android:name</span>=<span class="stringliteral">&quot;com.google.firebase.iid.FirebaseInstanceIdReceiver&quot;</span></div><div class="line">  <span class="keyword">android:exported</span>=<span class="stringliteral">&quot;true&quot;</span></div><div class="line">  <span class="keyword">android:permission</span>=<span class="stringliteral">&quot;com.google.android.c2dm.permission.SEND&quot;</span> &gt;</div><div class="line">    &lt;<span class="keywordtype">intent-filter</span>&gt;</div><div class="line">        &lt;<span class="keywordtype">action</span> <span class="keyword">android:name</span>=<span class="stringliteral">&quot;com.google.android.c2dm.intent.RECEIVE&quot;</span> /&gt;</div><div class="line">        &lt;<span class="keywordtype">action</span> <span class="keyword">android:name</span>=<span class="stringliteral">&quot;com.google.android.c2dm.intent.REGISTRATION&quot;</span> /&gt;</div><div class="line">        &lt;<span class="keywordtype">category</span> <span class="keyword">android:name</span>=<span class="stringliteral">&quot;${applicationId}&quot;</span> /&gt;</div><div class="line">    &lt;/<span class="keywordtype">intent-filter</span>&gt;</div><div class="line">&lt;/<span class="keywordtype">receiver</span>&gt;</div></div><!-- fragment --><h2>Create your Service</h2>
<p>If you want to do any messaging handling beyond receiving notifications on apps in the background, such as receiving notifications in foregrounded apps, receiving data payloads, or sending upstream messages.</p>
<p>The service should extend <code>FirebaseMessagingService</code>, and declare the same intent filter as in the example below:</p>
<div class="fragment"><div class="line">[Service]</div><div class="line">[IntentFilter (new [] { &quot;com.google.firebase.MESSAGING_EVENT&quot; })]</div><div class="line">public class MyFirebaseMessagingService : FirebaseMessagingService</div><div class="line">{</div><div class="line">    public override void OnMessageReceived (RemoteMessage message)</div><div class="line">    {</div><div class="line">        // TODO(developer): Handle FCM messages here.</div><div class="line">        // If the application is in the foreground handle both data and notification messages here.</div><div class="line">        // Also if you intend on generating your own notifications as a result of a received FCM</div><div class="line">        // message, here is where that should be initiated. See sendNotification method below.</div><div class="line">        Android.Util.Log.Debug (TAG, &quot;From: &quot; + message.From);</div><div class="line">        Android.Util.Log.Debug (TAG, &quot;Notification Message Body: &quot; + message.GetNotification ().Body);</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>You will also need a service that subclasses <code>FirebaseInstanceIdService</code> to handle the creation, rotation, and updating of registration tokens. These tokens are required for sending notifications to specific devices, or adding devices to device groups:</p>
<div class="fragment"><div class="line">[Service]</div><div class="line">[IntentFilter (new [] { &quot;com.google.firebase.INSTANCE_ID_EVENT&quot; })]</div><div class="line">public class MyFirebaseIIDService : FirebaseInstanceIdService</div><div class="line">{</div><div class="line">    /**</div><div class="line">     * Called if InstanceID token is updated. This may occur if the security of</div><div class="line">     * the previous token had been compromised. Note that this is called when the InstanceID token</div><div class="line">     * is initially generated so this is where you would retrieve the token.</div><div class="line">     */</div><div class="line">    public override void OnTokenRefresh ()</div><div class="line">    {</div><div class="line">        // Get updated InstanceID token.</div><div class="line">        var refreshedToken = FirebaseInstanceId.Instance.Token;</div><div class="line"></div><div class="line">        // TODO: Implement this method to send any registration to your app&#39;s servers.</div><div class="line">    }</div><div class="line">}</div></div><!-- fragment --><p>If FCM is critical to the Android app's function, be sure to set the minimum SDK Version to 8 or higher. This ensures that the Android app cannot be installed in an environment in which it could not run properly.</p>
<h3>Check for Google Play Services APK</h3>
<p>Apps that rely on the Play Services SDK should always check the device for a compatible Google Play services APK before accessing Google Play services features. It is recommended to do this in two places: in the main activity's <code>OnCreate ()</code> method, and in its <code>OnResume ()</code> method.</p>
<p>The check in <code>OnCreate ()</code> ensures that the app can't be used without a successful check. The check in <code>OnResume ()</code> ensures that if the user returns to the running app through some other means, such as through the back button, the check is still performed. If the device doesn't have a compatible Google Play services APK, your app can call <code>GooglePlayServicesUtil.GetErrorDialog ()</code> to allow users to download the APK from the Google Play Store or enable it in the device's system settings.</p>
<h2>Access the device registration token</h2>
<p>On initial startup of your app, the FCM SDK generates a registration token for the client app instance. If you want to target single devices or create device groups, you'll need to access this token by extending <code>FirebaseInstanceIdService</code> as in the previous example.</p>
<p>This section describes how to retrieve the token and how to monitor changes to the token. Because the token could be rotated after initial startup, you are strongly recommended to retrieve the latest updated registration token.</p>
<p>The registration token may change when:</p>
<ul>
<li>The app deletes Instance ID</li>
<li>The app is restored on a new device</li>
<li>The user uninstalls/reinstall the app</li>
<li>The user clears app data.</li>
<li>Retrieve the current registration token</li>
</ul>
<p>When you need to retrieve the current token, call <code>FirebaseInstanceID.Instance.Token</code>. This property returns null if the token has not yet been generated.</p>
<h3>Monitor token generation</h3>
<p>The <code>OnTokenRefreshcallback</code> method fires whenever a new token is generated, so accessing <code>Token</code> in its context ensures that you are accessing a current, available registration token. Make sure you have added the service to your manifest, then call <code>Token</code> in the context of <code>OnTokenRefresh</code>, and log the value as shown:</p>
<div class="fragment"><div class="line">public override void OnTokenRefresh ()</div><div class="line">{</div><div class="line">    // Get updated InstanceID token.</div><div class="line">    var refreshedToken = FirebaseInstanceId.Instance.Token;</div><div class="line">    Android.Util.Log.Debug (TAG, &quot;Refreshed token: &quot; + refreshedToken);</div><div class="line"></div><div class="line">    // If you want to send messages to this application instance or</div><div class="line">    // manage this apps subscriptions on the server side, send the</div><div class="line">    // Instance ID token to your app server.</div><div class="line">    sendRegistrationToServer(refreshedToken);</div><div class="line">}</div></div><!-- fragment --><p>After you've obtained the token, you can send it to your app server and store it using your preferred method.</p>
<h1>Samples </h1>
<p>You can find a <a class="el" href="namespace_sample.html">Sample</a> Application within each Firebase component. The sample will demonstrate the necessary configuration and some basic API usages.</p>
<h1>Learn More </h1>
<p>You can learn more about the various Firebase SDKs &amp; APIs by visiting the official <a href="https://firebase.google.com/" title="Firebase">Firebase</a> documentation </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
